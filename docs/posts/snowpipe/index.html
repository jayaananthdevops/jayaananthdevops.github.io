<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="light">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Continuous Data Ingestion with Snowpipe and Stream in Snowflake" />
<meta name="author" content="JayaAnanth" />
<meta property="og:locale" content="en" />
<meta name="description" content="Jayaananth is a Data Consultant with over 12 years of experience in the data modeling design, integration, extraction, loading, maintaining, decision support and reporting systems. He has extensive knowledge in Data warehousing concept and ETL/ELT development(ie Redshift,Snowflake).He has strong experience in optimising and performance tunning in the Database and has successfully delivered multiple projects. He is highly interested in Data lake, modern data architecture.." />
<meta property="og:description" content="Jayaananth is a Data Consultant with over 12 years of experience in the data modeling design, integration, extraction, loading, maintaining, decision support and reporting systems. He has extensive knowledge in Data warehousing concept and ETL/ELT development(ie Redshift,Snowflake).He has strong experience in optimising and performance tunning in the Database and has successfully delivered multiple projects. He is highly interested in Data lake, modern data architecture.." />
<link rel="canonical" href="http://localhost:4000/posts/snowpipe/" />
<meta property="og:url" content="http://localhost:4000/posts/snowpipe/" />
<meta property="og:site_name" content="JayaAnanth" />
<meta property="og:image" content="http://localhost:4000/assets/snowpipe/snowflake_stream.png" />
<meta property="og:image:alt" content="Snowpipe Stream Task" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-10-15T12:00:00+11:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/snowpipe/snowflake_stream.png" />
<meta name="twitter:image:alt" content="Snowpipe Stream Task" />
<meta property="twitter:title" content="Continuous Data Ingestion with Snowpipe and Stream in Snowflake" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="twitter:creator" content="@JayaAnanth" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"JayaAnanth","url":"https://jayaananthdevops.github.io/"},"dateModified":"2023-10-26T10:41:05+11:00","datePublished":"2023-10-15T12:00:00+11:00","description":"Jayaananth is a Data Consultant with over 12 years of experience in the data modeling design, integration, extraction, loading, maintaining, decision support and reporting systems. He has extensive knowledge in Data warehousing concept and ETL/ELT development(ie Redshift,Snowflake).He has strong experience in optimising and performance tunning in the Database and has successfully delivered multiple projects. He is highly interested in Data lake, modern data architecture..","headline":"Continuous Data Ingestion with Snowpipe and Stream in Snowflake","image":{"alt":"Snowpipe Stream Task","url":"http://localhost:4000/assets/snowpipe/snowflake_stream.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/snowpipe/"},"url":"http://localhost:4000/posts/snowpipe/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Continuous Data Ingestion with Snowpipe and Stream in Snowflake | JayaAnanth
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="JayaAnanth">
<meta name="application-name" content="JayaAnanth">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    
      <link rel="preconnect" href="https://cdnjs.cloudflare.com" >
      <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/cloud.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">JayaAnanth</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Data Consultant at Cevo,Sydney</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/contact/" class="nav-link">
            <i class="fa-fw fas fa-envelope"></i>
            

            <span>SUBSCRIBE</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/buymecoffee/" class="nav-link">
            <i class="fa-fw fas fa-coffee"></i>
            

            <span>BUY ME A COFFEE</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/jaydataconsultant"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/jayaananth/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['datainevitable','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Continuous Data Ingestion with Snowpipe and Stream in Snowflake</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Continuous Data Ingestion with Snowpipe and Stream in Snowflake</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1697331600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 15, 2023
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1698277265"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 26, 2023
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/snowpipe/snowflake_stream.png" class="popup img-link preview-img shimmer"><img src="/assets/snowpipe/snowflake_stream.png"  alt="Snowpipe Stream Task" width="1200" height="630"  loading="lazy"></a><figcaption class="text-center pt-2 pb-2">Snowpipe Stream Task</figcaption></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://jayaananthdevops.github.io/">JayaAnanth</a>
                
              
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1117 words"
>
  <em>6 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-56G57XP8PY"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-56G57XP8PY');
</script>

<h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Snowflake data pipelines offer significant benefits to organisations by streamlining and automating data processing workflows. Snowflake pipelines revolutionise data management and empower organisations to derive valuable insights from their data assets in a more efficient and timely manner.</p>

<p>In this blog, we’ll explain how to create a Snowflake data pipeline to automate the manual processes involved in creating and managing ELT logic for transforming and improving continuous data loads.</p>

<h2 id="definitions"><span class="me-2">Definitions</span><a href="#definitions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><strong>Snowpipe</strong>
 <a href="https://docs.snowflake.com/en/user-guide/data-load-snowpipe-intro"> Snowpipe </a> is a cloud-native, real-time data ingestion service provided by Snowflake. It allows you to load data into Snowflake tables automatically as new data arrives in your cloud storage (e.g., Amazon S3 or Azure Blob Storage).</p>

<p><strong>Change Data Capture</strong>
Change Data Capture <a href="https://www.redhat.com/en/topics/integration/what-is-change-data-capture#what-is-cdc"> CDC </a>  is a technique used to capture and propagate changes made to a database in real-time. CDC identifies and captures data changes, such as inserts, updates, and deletes, from a source system’s transaction log. It provides a reliable and efficient way to track data changes and replicate them to target systems.</p>

<p><strong>Stream</strong>
<a href="https://docs.snowflake.com/en/sql-reference/sql/create-streamrecords"> A stream </a> data manipulation language (DML) changes made to a table, directory table, external table, or the underlying tables in a view (including secure views). The object for which changes are recorded is called the source object.</p>

<h2 id="architecture"><span class="me-2">Architecture</span><a href="#architecture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>The following diagram represents the architecture of the Snowflake data pipeline.</p>

<p><a href="/assets/snowpipe/sf-architect.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-architect.png" alt="img-description" loading="lazy"></a>
<em>Snowpipe Architect</em></p>

<h2 id="creating-a-snowflake-data-pipeline"><span class="me-2">Creating a Snowflake data pipeline</span><a href="#creating-a-snowflake-data-pipeline" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>To establish uninterrupted data pipelines, we will leverage the following Snowflake features:</p>

<ul>
  <li>Utilising an external stage on Amazon S3</li>
  <li>Employing SnowPipe, a feature within Snowflake</li>
  <li>Leveraging streams functionality</li>
  <li>Utilising tasks to enable continuous data pipelines</li>
  <li>Implementing stored procedures to support the uninterrupted flow of data.</li>
</ul>

<h2 id="step-1-create-an-iam-role-for-snowflake-to-access-data-in-s3-bucket"><span class="me-2">Step 1: Create an IAM Role for Snowflake to access data in S3 bucket</span><a href="#step-1-create-an-iam-role-for-snowflake-to-access-data-in-s3-bucket" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Creating an IAM Role specifically for Snowflake to access the S3 bucket ensures secure, controlled, and auditable access to the data.</p>

<p><a href="/assets/snowpipe/sf-iam.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-iam.png" alt="img-description" loading="lazy"></a>
<em>IAM Role</em></p>

<h2 id="step-2-create-an-aws-s3-bucket-and-upload-sample-files"><span class="me-2">Step 2: Create an AWS S3 bucket and upload sample files.</span><a href="#step-2-create-an-aws-s3-bucket-and-upload-sample-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>This step involves setting up an external stage on Amazon S3, a storage service provided by Amazon Web Services. This stage serves as a destination for receiving input files that will be used in the data processing workflow.
Once the input files are placed in the designated S3 bucket, Snowpipe, a specialised feature within Snowflake, is triggered. Snowpipe automatically detects new files added to the S3 bucket and initiates the subsequent steps in the data pipeline.</p>

<p><a href="/assets/snowpipe/sf-s3.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-s3.png" alt="img-description" loading="lazy"></a>
<em>AWS S3 Bucket</em></p>

<h2 id="step-3-create-an-integration-object-in-snowflake"><span class="me-2">Step 3: Create an integration object in Snowflake.</span><a href="#step-3-create-an-integration-object-in-snowflake" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="https://docs.snowflake.com/en/sql-reference/sql/create-storage-integration"> Storage integration </a> is a Snowflake object that stores a generated identity and access management (IAM) entity for your external cloud storage, along with an optional set of allowed or blocked storage locations (Amazon S3, Google Cloud Storage, or Microsoft Azure).</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">STORAGE</span> <span class="n">INTEGRATION</span> <span class="n">aws_sf_data_load</span>
  <span class="k">TYPE</span> <span class="o">=</span> <span class="n">EXTERNAL_STAGE</span>
  <span class="n">STORAGE_PROVIDER</span> <span class="o">=</span> <span class="n">S3</span>
  <span class="n">ENABLED</span> <span class="o">=</span> <span class="k">TRUE</span>
  <span class="n">STORAGE_AWS_ROLE_ARN</span> <span class="o">=</span> <span class="s1">'arn:aws:iam::xxxxxxxxxxx:role/snowflake-aws-jay'</span>
  <span class="n">STORAGE_ALLOWED_LOCATIONS</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'s3://snowflake-continousingestion/'</span><span class="p">);</span></code></pre></figure>

<p>Snowflake’s External_ID and IAM User ARN are required to access AWS.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">desc</span> <span class="n">INTEGRATION</span> <span class="n">aws_sf_data_load</span><span class="p">;</span></code></pre></figure>

<p><a href="/assets/snowpipe/sf-desc-int.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-desc-int.png" alt="img-description" loading="lazy"></a>
<em>Description Table</em></p>

<p>Under ‘trust relationships’ within the IAM Role, add External_ID and IAM User ARN.</p>

<p><a href="/assets/snowpipe/sf-trust.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-trust.png" alt="img-description" loading="lazy"></a>
<em>External_ID</em></p>

<h2 id="step-4"><span class="me-2">Step 4:</span><a href="#step-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>In Snowflake, construct a file format object.</p>

<p><a href="https://docs.snowflake.com/en/sql-reference/sql/create-file-format"> A file format </a> is a configuration that specifies how data is organised and structured within files that are loaded into or exported from Snowflake tables.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="n">FILE</span> <span class="n">FORMAT</span> <span class="n">csv_load_format</span>
    <span class="k">TYPE</span> <span class="o">=</span> <span class="s1">'CSV'</span> 
    <span class="n">COMPRESSION</span> <span class="o">=</span> <span class="s1">'AUTO'</span> 
    <span class="n">FIELD_DELIMITER</span> <span class="o">=</span> <span class="s1">','</span> 
    <span class="n">RECORD_DELIMITER</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span> 
    <span class="n">SKIP_HEADER</span> <span class="o">=</span><span class="mi">1</span> 
    <span class="n">FIELD_OPTIONALLY_ENCLOSED_BY</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\0</span><span class="s1">42'</span> 
    <span class="n">TRIM_SPACE</span> <span class="o">=</span> <span class="k">FALSE</span> 
    <span class="n">ERROR_ON_COLUMN_COUNT_MISMATCH</span> <span class="o">=</span> <span class="k">TRUE</span> 
    <span class="k">ESCAPE</span> <span class="o">=</span> <span class="s1">'NONE'</span> 
    <span class="n">ESCAPE_UNENCLOSED_FIELD</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\1</span><span class="s1">34'</span> 
    <span class="n">DATE_FORMAT</span> <span class="o">=</span> <span class="s1">'AUTO'</span> 
    <span class="n">TIMESTAMP_FORMAT</span> <span class="o">=</span> <span class="s1">'AUTO'</span><span class="p">;</span></code></pre></figure>

<h2 id="step-5-create-a-stage-object-in-snowflake"><span class="me-2">Step 5: Create a stage object in Snowflake.</span><a href="#step-5-create-a-stage-object-in-snowflake" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="https://docs.snowflake.com/en/user-guide/data-load-internal-tutorial-create-stage"> A stage </a> specifies where data files are stored (i.e. “staged”) so that the data in the files can be loaded into a table. A named stage is a cloud storage location managed by Snowflake. Creating a named stage is useful if you want multiple users or processes to upload files.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="n">stage</span> <span class="n">stg_lairport_details_csv_dev</span>
<span class="n">storage_integration</span> <span class="o">=</span> <span class="n">aws_sf_data_load</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">'s3://snowflake-continousingestion/airport_details/csv/'</span>
<span class="n">file_format</span> <span class="o">=</span> <span class="n">csv_load_format</span><span class="p">;</span></code></pre></figure>

<h2 id="step-6--create-a-snowpipe"><span class="me-2">Step 6:  Create a Snowpipe.</span><a href="#step-6--create-a-snowpipe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>We can now develop snowpipe to automatically ingest data from S3 to Snowflake because we have defined stage, table, and file format. The snowpipe will pick up and load a new file into the raw table whenever a new file is placed in the bucket.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">create</span> <span class="k">or</span> <span class="k">replace</span> <span class="n">pipe</span> <span class="n">airport_details_pipe</span> <span class="n">auto_ingest</span><span class="o">=</span><span class="k">true</span> <span class="k">as</span>
<span class="k">copy</span> <span class="k">into</span> <span class="n">airport_raw_details</span> <span class="k">from</span> <span class="o">@</span><span class="n">stg_airport_details_csv_dev</span> <span class="n">ON_ERROR</span> <span class="o">=</span> <span class="k">continue</span><span class="p">;</span></code></pre></figure>

<p><a href="/assets/snowpipe/sf-showpipe.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-showpipe.png" alt="img-description" loading="lazy"></a>
<em>Description Table</em></p>

<p>Subscribe the Snowflake SQS Queue in s3:. To do this:</p>
<ul>
  <li>Log in to AWS Console</li>
  <li>Click on properties</li>
  <li>Click on create event notification</li>
  <li>Type event name (prefix and suffix are optional)</li>
  <li>Select all object create events</li>
  <li>Select SQS queue in destination → Select “enter SQS queue ARN” in the Specify SQS queue</li>
  <li>Paste the ARN(notification_channel) copied from Snowflake in the SQS queue box</li>
  <li>Save changes</li>
</ul>

<p><a href="/assets/snowpipe/sf-event.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-event.png" alt="img-description" loading="lazy"></a>
<em>Event Notification</em></p>

<p><a href="/assets/snowpipe/sf-dest.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-dest.png" alt="img-description" loading="lazy"></a>
<em>Destinations</em></p>

<p><a href="/assets/snowpipe/sf-summary.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-summary.png" alt="img-description" loading="lazy"></a>
<em>Summary</em></p>

<h2 id="step-7-create-a-stream-on-the-raw-table"><span class="me-2">Step 7: Create a stream on the raw table.</span><a href="#step-7-create-a-stream-on-the-raw-table" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="n">STREAM</span> <span class="n">airport_std_stream</span> <span class="k">ON</span> <span class="k">TABLE</span> <span class="n">airport_raw_details</span><span class="p">;</span></code></pre></figure>

<p>For any new DML operations performed in the table, the changes will be captured in the stream table as below.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">airport_std_stream</span><span class="p">;</span></code></pre></figure>

<p><a href="/assets/snowpipe/sf-airport-stream.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-airport-stream.png" alt="img-description" loading="lazy"></a>
<em>Table Result</em></p>

<h2 id="step-8create-a-task"><span class="me-2">Step 8:Create a task.</span><a href="#step-8create-a-task" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>In Snowflake, <a href="https://docs.snowflake.com/en/user-guide/tasks-intro"> a task </a> is a feature that enables the automation of various actions and processes within the Snowflake data warehouse. It allows you to schedule and execute a series of SQL statements or stored procedures as a single unit.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">create</span> <span class="k">or</span> <span class="k">replace</span> <span class="n">task</span> <span class="n">airport_load_tsk</span> 
<span class="n">warehouse</span> <span class="o">=</span> <span class="n">compute_wh</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="s1">'1 minute'</span>
<span class="k">when</span> <span class="k">system</span><span class="err">$</span><span class="n">stream_has_data</span><span class="p">(</span><span class="s1">'airport_std_stream'</span><span class="p">)</span>
<span class="k">as</span> 
<span class="n">merge</span> <span class="k">into</span> <span class="n">airport_prod_details</span> <span class="k">as</span> <span class="n">li</span> 
<span class="k">using</span> 
<span class="p">(</span>
   <span class="k">select</span> 
        <span class="n">AIRLINE_ID</span><span class="p">,</span>
        <span class="n">AIRLINE_DESCRIPTION</span>
        
    <span class="k">from</span> 
        <span class="n">airport_std_stream</span>
    <span class="k">where</span> <span class="n">metadata</span><span class="err">$</span><span class="n">action</span><span class="o">=</span><span class="s1">'INSERT'</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">li_stg</span>
<span class="k">on</span> <span class="n">li</span><span class="p">.</span><span class="n">AIRLINE_ID</span> <span class="o">=</span> <span class="n">li_stg</span><span class="p">.</span><span class="n">AIRLINE_ID</span> 
<span class="k">when</span> <span class="n">matched</span> <span class="k">then</span> <span class="k">update</span> 
<span class="k">set</span> 
    <span class="n">li</span><span class="p">.</span><span class="n">AIRLINE_ID</span> <span class="o">=</span> <span class="n">li_stg</span><span class="p">.</span><span class="n">AIRLINE_ID</span><span class="p">,</span>
    <span class="n">li</span><span class="p">.</span><span class="n">AIRLINE_DESCRIPTION</span> <span class="o">=</span> <span class="n">li_stg</span><span class="p">.</span><span class="n">AIRLINE_DESCRIPTION</span>
<span class="k">when</span> <span class="k">not</span> <span class="n">matched</span> <span class="k">then</span> <span class="k">insert</span> 
<span class="p">(</span>
    <span class="n">AIRLINE_ID</span><span class="p">,</span>
    <span class="n">AIRLINE_DESCRIPTION</span>
<span class="p">)</span> 
<span class="k">values</span> 
<span class="p">(</span>
    <span class="n">li_stg</span><span class="p">.</span><span class="n">AIRLINE_ID</span><span class="p">,</span>
    <span class="n">li_stg</span><span class="p">.</span><span class="n">AIRLINE_DESCRIPTION</span>
<span class="p">);</span></code></pre></figure>

<p>Making use of the altered data captured in streams, you can create tasks to execute SQL queries or procedures. In accordance with a timetable for running SQL statements, including those that invoke stored procedures, you can schedule tasks to execute repeatedly.</p>

<p>Instead of always using the entire source table, we may utilise the TASK’s MERGE statement to MERGE only the changes (streams) from the source table to the target table.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">ALTER</span> <span class="n">TASK</span> <span class="n">airport_load_tsk</span> <span class="n">RESUME</span><span class="p">;</span>

<span class="k">EXECUTE</span> <span class="n">TASK</span> <span class="n">airport_load_tsk</span></code></pre></figure>

<p>Next, validate the result.Once Streams capture any data change on the source table(AIRPORT_RAW_DETAILS). So all the new data added to the Target table AIRPORT_PROD_DETAILS.</p>

<p><a href="/assets/snowpipe/sf-prod-details.png" class="popup img-link  shimmer"><img src="/assets/snowpipe/sf-prod-details.png" alt="img-description" loading="lazy"></a>
<em>Prod Details</em></p>

<h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>In this post, we have discussed how to create the Snowflake data pipeline. By implementing Snowflake data pipelines, organisations can unlock the full potential of their data assets, enabling efficient and automated data processing, real-time insights, improved data quality, cost optimisation, and enhanced data governance. These benefits contribute to informed decision-making, improved operational efficiency, and a competitive advantage in the data-driven business landscape.</p>

<p><strong>Note:</strong> This article was originally published on <a href="https://cevo.com.au/post/continuous-data-ingestion-with-snowpipe-and-stream-in-snowflake/"> Cevo Australia’s website </a></p>

<p><strong>If you enjoy the article, Please Subscribe.</strong></p>
<h2 id="if-you-love-the-article-please-consider-supporting-me-by-buying-a-coffee-for-1"><span class="me-2">If you love the article, Please consider supporting me by buying a coffee for $1.</span><a href="#if-you-love-the-article-please-consider-supporting-me-by-buying-a-coffee-for-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="jayaananth" data-color="#FFDD00" data-emoji="☕" data-font="Cookie" data-text="Buy me a coffee @ 1$" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff"></script>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4606733459883553" crossorigin="anonymous"></script>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/snowflake/">Snowflake</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/snowflake/"
            class="post-tag no-text-decoration"
          >snowflake</a>
        
          <a
            href="/tags/snowflake-snowpipe/"
            class="post-tag no-text-decoration"
          >snowflake snowpipe</a>
        
          <a
            href="/tags/snowflake-stream/"
            class="post-tag no-text-decoration"
          >snowflake stream</a>
        
          <a
            href="/tags/cdc/"
            class="post-tag no-text-decoration"
          >cdc</a>
        
          <a
            href="/tags/snowflake-task/"
            class="post-tag no-text-decoration"
          >snowflake task</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Continuous%20Data%20Ingestion%20with%20Snowpipe%20and%20Stream%20in%20Snowflake%20-%20JayaAnanth&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fsnowpipe%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Continuous%20Data%20Ingestion%20with%20Snowpipe%20and%20Stream%20in%20Snowflake%20-%20JayaAnanth&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fsnowpipe%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fsnowpipe%2F&text=Continuous%20Data%20Ingestion%20with%20Snowpipe%20and%20Stream%20in%20Snowflake%20-%20JayaAnanth" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/aws_xml_athena/">Efficient XML Data Processing and Querying with AWS Glue and Athena - A Comprehensive Guide</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/SparkInterviewquestions-Beginner-Part1/">SPARK Interview Questions Beginner PART-1</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/dynamicmasking/">Snowflake Dynamic Data Masking: Enhancing Data Security and Compliance</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/snowflakedynamictable/">Dynamic Table in Snowflake : Implementing Type 2 Slowly Changing Dimensions (SCD) with Flexibility and Efficiency</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/dbtec2/">Introduction to DBT Tool & Install and Running in EC2 machine</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/snowflake/">snowflake</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dbt/">dbt</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/mwaa/">mwaa</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ecs/">ecs</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/project/">project</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/spark/">spark</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/airflow/">airflow</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/athena/">athena</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cdc/">cdc</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/data-security/">data security</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/dbtec2/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1696554000"
  data-df="ll"
  
>
  Oct  6, 2023
</time>

              <h4 class="pt-0 my-2">Introduction to DBT Tool & Install and Running in EC2 machine</h4>
              <div class="text-muted">
                <p>
                  





                  




What is DBT?

DBT  (data build tool) enables analytics engineers to transform data in their warehouses by simply writing select statements. DBT handles turning these select statements into tab...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/snowflake_dbt_ecs_part1/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1698109200"
  data-df="ll"
  
>
  Oct 24, 2023
</time>

              <h4 class="pt-0 my-2">Part 1 - Orchestrating Snowflake Data Transformations with DBT on Amazon ECS through Apache Airflow.</h4>
              <div class="text-muted">
                <p>
                  





                  




Overview:
This blog offers a comprehensive walkthrough for setting up DBT to execute data transformation tasks specifically designed for Snowflake. We’ve streamlined the DBT configuration proc...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/snowflake_dbt_ecs_part2/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1698109200"
  data-df="ll"
  
>
  Oct 24, 2023
</time>

              <h4 class="pt-0 my-2">Part 2 - Orchestrating Snowflake Data Transformations with DBT on Amazon ECS through Apache Airflow</h4>
              <div class="text-muted">
                <p>
                  





                  




Overview:
In our previous post, we explored the setup of DBT on an ECR private repository through an AWS pipeline. In this blog, our emphasis will be on configuring MWAA and initiating DBT pro...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/dbtec2/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Introduction to DBT Tool & Install and Running in EC2 machine</p>
    </a>
  

  
    <a
      href="/posts/EMRserverless/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Building Serverless PySpark Jobs with EMR-Serverless and MWAA</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->

  
  <!-- The Disqus lazy loading. -->

<div id="disqus_thread">
  <p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p>
</div>

<script type="text/javascript">
  var disqus_config = function () {
    this.page.url = 'http://localhost:4000/posts/snowpipe/';
    this.page.identifier = '/posts/snowpipe/';
  };

  /* Lazy loading */
  var disqus_observer = new IntersectionObserver(
    function (entries) {
      if (entries[0].isIntersecting) {
        (function () {
          var d = document,
            s = d.createElement('script');
          s.src = 'https://datainevitable.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();

        disqus_observer.disconnect();
      }
    },
    { threshold: [0] }
  );

  disqus_observer.observe(document.querySelector('#disqus_thread'));

  /* Auto switch theme */
  function reloadDisqus() {
    if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
      /* Disqus hasn't been loaded */
      if (typeof DISQUS === 'undefined') {
        return;
      }

      if (document.readyState == 'complete') {
        DISQUS.reset({ reload: true, config: disqus_config });
      }
    }
  }

  if (document.querySelector('.mode-toggle')) {
    window.addEventListener('message', reloadDisqus);
  }
</script>



            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2024</time>

    
      <a href="https://github.com/jaydataconsultant">JayaAnanth</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/snowflake/">snowflake</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dbt/">dbt</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/mwaa/">mwaa</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ecs/">ecs</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/project/">project</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/spark/">spark</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/airflow/">airflow</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/athena/">athena</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cdc/">cdc</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/data-security/">data security</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

